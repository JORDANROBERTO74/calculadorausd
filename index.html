<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Calculadora de Transacciones Comerciales</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="styles.css" />
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
  </head>
  <body>
    <div class="container">
      <header style="padding-top: 10px">
        <h1>Calculadora de Transacciones</h1>
        <p>Calcula ganancias, comisiones y reintegros de tus ventas</p>
      </header>

      <main>
        <!-- Sección de Entrada de Datos -->
        <form id="calculadoraForm" onsubmit="calcularTransaccion(event)">
          <section class="input-section">
            <h2><i data-lucide="bar-chart-3"></i> Datos de Entrada</h2>

            <div class="pagos-container">
              <h3><i data-lucide="credit-card"></i> Pagos Realizados (Bs)</h3>
              <div id="pagosList">
                <div class="pago-item">
                  <label>Pago 1:</label>
                  <div class="input-button-container">
                    <input
                      required
                      type="number"
                      class="pago-input"
                      step="0.01"
                      placeholder="Ej: 324.12"
                    />
                    <button
                      type="button"
                      class="btn-remove"
                      onclick="removePago(this)"
                    >
                      <i data-lucide="x"></i>
                    </button>
                  </div>
                </div>
              </div>
              <button type="button" class="btn-add" onclick="addPago()">
                <i data-lucide="plus"></i> Agregar Pago
              </button>
            </div>

            <div class="form-group">
              <label for="dolaresVenta">Dólares adquiridos:</label>
              <input
                required
                type="number"
                id="dolaresVenta"
                step="0.01"
                placeholder="Ej: 100"
              />
            </div>

            <div class="form-group">
              <div
                style="
                  display: flex;
                  align-items: center;
                  gap: 15px;
                  margin-bottom: 8px;
                "
              >
                <label for="tipoCambio" style="margin-bottom: 0"
                  >Tipo de Cambio Paralelo (Venta):</label
                >
              </div>
              <div style="display: flex; gap: 10px; align-items: center">
                <input
                  required
                  type="number"
                  id="tipoCambio"
                  step="0.01"
                  value="6.97"
                  required
                  style="flex: 1"
                  placeholder="Obteniendo precio P2P..."
                />
                <button
                  type="button"
                  id="btnPrecioP2P"
                  onclick="obtenerPrecioDolar()"
                  style="
                    background: linear-gradient(135deg, #00d4aa, #33e0b8);
                    color: white;
                    border: none;
                    padding: 8px 16px;
                    border-radius: 10px;
                    cursor: pointer;
                    font-size: 0.85rem;
                    font-weight: 600;
                    transition: all 0.3s ease;
                    white-space: nowrap;
                    box-shadow: 0 3px 10px rgba(0, 212, 170, 0.3);
                    font-family: 'Inter', sans-serif;
                    display: flex;
                    align-items: center;
                    gap: 6px;
                  "
                  onmouseover="if(!this.disabled) { this.style.background='linear-gradient(135deg, #33E0B8, #00B894)'; this.style.transform='translateY(-2px)'; this.style.boxShadow='0 5px 15px rgba(0, 212, 170, 0.4)' }"
                  onmouseout="if(!this.disabled) { this.style.background='linear-gradient(135deg, #00D4AA, #33E0B8)'; this.style.transform='translateY(0)'; this.style.boxShadow='0 3px 10px rgba(0, 212, 170, 0.3)' }"
                >
                  <span id="btnPrecioIcon"
                    ><i data-lucide="dollar-sign"></i
                  ></span>
                  <span id="btnPrecioText">Precio P2P</span>
                </button>
              </div>
              <small style="color: #7f8c8d; font-size: 0.85rem"
                >💡 Obtiene precios reales de Binance P2P y AirTM</small
              >
            </div>

            <div class="form-group">
              <label for="comisionPorcentaje">Comisión LLC (%):</label>
              <input
                required
                type="number"
                id="comisionPorcentaje"
                step="0.1"
                value="30"
                required
              />
            </div>

            <div class="form-group">
              <label for="gananciaPorcentaje">Tu Comisión (%):</label>
              <input
                required
                type="number"
                id="gananciaPorcentaje"
                step="0.1"
                value="50"
                required
              />
            </div>

            <button type="submit" class="btn-calculate">
              <i data-lucide="calculator"></i> Calcular Transacción
            </button>
          </section>
        </form>

        <!-- Sección de Resultados -->
        <section
          class="results-section"
          id="resultsSection"
          style="display: none"
        >
          <div class="proforma-header">
            <h2><i data-lucide="file-text"></i> COTIZACIÓN DE TRANSACCIÓN</h2>
            <div class="proforma-meta">
              <span class="proforma-date" id="proformaDate"></span>
              <span class="proforma-id" id="proformaId"></span>
            </div>
          </div>

          <div class="proforma-content">
            <!-- Detalles de la Operación -->
            <div class="proforma-section">
              <h3>
                <i data-lucide="bar-chart-3"></i> Detalles de la Operación
              </h3>
              <div class="proforma-grid">
                <div class="proforma-item">
                  <span class="label">Total Invertido:</span>
                  <span class="value" id="totalInvertido">0.00 Bs</span>
                </div>
                <div class="proforma-item">
                  <span class="label">Dólares Adquiridos:</span>
                  <span class="value" id="dolaresMostrar">0 USD</span>
                </div>
                <div class="proforma-item">
                  <span class="label">Tipo de Cambio:</span>
                  <span class="value" id="tipoCambioMostrar">0.00 Bs/USD</span>
                </div>
              </div>
            </div>

            <!-- Resultados para el Cliente -->
            <div class="proforma-section">
              <h3>
                <i data-lucide="dollar-sign"></i> Resultados de la Operación
              </h3>
              <div class="proforma-grid">
                <div class="proforma-item">
                  <span class="label">Valor Final en Bs:</span>
                  <span class="value" id="valorDolares">0.00 Bs</span>
                </div>
                <div class="proforma-item highlight">
                  <span class="label">Ganancia Obtenida:</span>
                  <span class="value" id="gananciaCliente">0.00 Bs</span>
                </div>
                <div class="proforma-item">
                  <span class="label">Rentabilidad:</span>
                  <span class="value" id="rentabilidad">0.00%</span>
                </div>
              </div>
            </div>

            <!-- Resumen Final -->
            <div class="proforma-section total-section">
              <h3><i data-lucide="dollar-sign"></i> Resumen Final</h3>
              <div class="proforma-grid">
                <div class="proforma-item">
                  <span class="label">Inversión Inicial:</span>
                  <span class="value" id="resumenInversion">0.00 Bs</span>
                </div>
                <div class="proforma-item">
                  <span class="label">Ganancia Cliente:</span>
                  <span class="value" id="resumenGanancia">0.00 Bs</span>
                </div>
                <div class="proforma-item total">
                  <span class="label">Total a Entregar:</span>
                  <span class="value" id="resumenRetorno">0.00 Bs</span>
                </div>
              </div>
            </div>
          </div>

          <!-- Botones de Acción -->
          <div class="proforma-actions" style="display: flex; gap: 10px">
            <button
              type="button"
              class="btn-share"
              onclick="compartirWhatsAppCorto()"
            >
              <i data-lucide="smartphone"></i> Compartir en WhatsApp
            </button>
            <button
              type="button"
              class="btn-share"
              onclick="copiarContenidoWhatsApp()"
            >
              <i data-lucide="copy"></i> Copiar contenido
            </button>
          </div>
        </section>
      </main>

      <footer>
        <p>© 2024 Calculadora de Transacciones Comerciales</p>
      </footer>
    </div>

    <script src="script.js"></script>
    <script>
      // Initialize Lucide icons
      lucide.createIcons();
    </script>
  </body>
</html>
